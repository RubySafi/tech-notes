<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UI Controls: ListBox</title>
    <link rel="stylesheet" href="../../styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
  </head>
  <body>
    <div class="container">
      <h2>ListBox Control in C# (WinForms)</h2>
      <p>
        In C# Windows Forms applications, the <code>ListBox</code> control is used to display a list of items that the user can select. It is especially useful for presenting a collection of items in a vertical list.
      </p>

      <h3>Creating a ListBox Control</h3>
      <p>The following code demonstrates how to create a ListBox control and set its properties:</p>
      <code>Form.Designer.cs</code>
      <pre><code class="language-csharp">
using System.Windows.Forms;
using System.Drawing;

private ListBox listBox1;

private void InitializeComponent()
{
    listBox1 = new ListBox();

    // ListBox properties
    listBox1.Location = new Point(147, 150);
    listBox1.Name = "listBox1";
    listBox1.Size = new Size(121, 95);
    listBox1.TabIndex = 0;

    // Adding items to the ListBox
    listBox1.Items.Add("Item 1");
    listBox1.Items.Add("Item 2");
    listBox1.Items.Add("Item 3");

    // Add the ListBox to the form
    Controls.Add(listBox1);
}
      </code></pre>

      <p>To add a default set of items efficiently, you can use the following code instead:</p>
      <pre><code class="language-csharp">
listBox1.Items.AddRange(new object[] { "Item1", "Item2", "Item3" });
      </code></pre>

      <h3>Common Properties</h3>
      <p>Here are some commonly used properties for the <code>ListBox</code> control:</p>
      <code>Form.cs</code>
      <pre><code class="language-csharp">
listBox1.SelectedIndex = 0;    // Set the selected item by index
listBox1.SelectedItem = "Item 2";  // Set the selected item by value
      </code></pre>

      <p><strong>Note:</strong> These properties should be set in <code>Form.cs</code>, not in <code>Form.Designer.cs</code>.</p>

      <h3>Handling Events</h3>
      <p>To respond when the selected item changes, handle the <code>SelectedIndexChanged</code> event:</p>

      <code>Form.Designer.cs</code>
      <pre><code class="language-csharp">
listBox1.SelectedIndexChanged += listBox1_SelectedIndexChanged;
      </code></pre>

      <code>Form.cs</code>
      <pre><code class="language-csharp">
private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    // Code to handle the selected item change
    MessageBox.Show("Selected Item: " + listBox1.SelectedItem.ToString());
}
      </code></pre>

      <h3>Binding a List of Strings</h3>
      <p>To bind a list of strings to the ListBox, use the following code:</p>

      <code>Form.Designer.cs</code>
      <pre><code class="language-csharp">
this.listBox1 = new ListBox();

// Initialize the ListBox
this.listBox1.FormattingEnabled = true;
this.listBox1.Location = new Point(50, 50);
this.listBox1.Size = new Size(200, 100);

// Add the ListBox to the form
this.Controls.Add(this.listBox1);
      </code></pre>

      <code>Form.cs</code>
      <pre><code class="language-csharp">
List<string> items = new List<string> { "Item 1", "Item 2", "Item 3" };
listBox1.DataSource = items;

// Set the default selected value
listBox1.SelectedItem = "Item 2";
      </code></pre>

      <h3>Binding a List of Class Objects</h3>
      <p>To bind a list of class objects to the ListBox, use the following example:</p>

      <code>Form.Designer.cs</code>
      <pre><code class="language-csharp">
this.listBox1 = new ListBox();

// Initialize the ListBox
this.listBox1.FormattingEnabled = true;
this.listBox1.Location = new Point(50, 50);
this.listBox1.Size = new Size(200, 100);

// Add the ListBox to the form
this.Controls.Add(this.listBox1);
      </code></pre>

      <code>Form.cs</code>
      <pre><code class="language-csharp">
List<ClassA> classList = new List<ClassA>
{
    new ClassA { Name = "Item1", Id = 1 },
    new ClassA { Name = "Item2", Id = 2 }
};

// Set the display member for the ListBox
listBox1.DisplayMember = "Name";  // Display the 'Name' property of ClassA
listBox1.DataSource = classList;

// Set the default selected value
listBox1.SelectedItem = classList[1];
      </code></pre>

      <code>ClassA.cs</code>
      <pre><code class="language-csharp">
public class ClassA
{
    public string Name { get; set; }
    public int Id { get; set; }
}
      </code></pre>
    </div>

    <footer>&copy; 2025 Tech-Notes. All rights reserved.</footer>
  </body>
</html>
